  <!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="zh-CN" class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title> 科学上网--使用VPS搭建shadowsocks服务器 - Bowen Blog</title>
    <meta name="description" content="赵先生写日志的地方
">
    <meta name="robots" content="all">
    <meta name="author" content="ZhaoBowen fantastic.bowen@gmail.com">
    <meta name="keywords" content="Bowen 博客 blog 前端 NodeJS Shadowsocks,翻墙">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- 删除默认的苹果工具栏和菜单栏。 -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- 控制状态栏显示样式 -->
    <meta name="viewport" content="width=device-width,initial-scale = 1.0,maximum-scale = 1.0, user-scalable=no">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link href="/public/img/favicon.jpg" rel="shortcut icon">
    <link href="/public/img/favicon.jpg" rel="Bookmark">
    <!-- Standard iPhone -->
    <link rel="apple-touch-icon" sizes="57x57" href="/public/img/apple/apple-touch-icon-57x57-precomposed.png" />
    <!-- Standard iPad -->
    <link rel="apple-touch-icon" sizes="72x72" href="/public/img/apple/apple-touch-icon-72x72-precomposed.png" />
    <!-- Retina iPhone -->
    <link rel="apple-touch-icon" sizes="114x114" href="/public/img/apple/apple-touch-icon-114x114-precomposed.png" />
    <!-- Retina iPad -->
    <link rel="apple-touch-icon" sizes="144x144" href="/public/img/apple/apple-touch-icon-144x144-precomposed.png" />
    <link rel="stylesheet" href="/public/css/index.css">
    <!--<script src="js/vendor/modernizr-2.6.2.min.js"></script>
    <script src="http://cdn.bootcss.com/modernizr/2.8.3/modernizr.min.js"></script>-->
    <!--<link rel="stylesheet" href="bower_components/material-design-lite/material.min.css">
    <script src="bower_components/material-design-lite/material.min.js"></script>-->
    <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> -->
    <!-- <link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'> -->
</head>


  <body>

  <div class="wrapper">
    <header class="page-left">
    <div class="bg-img" style="background-image: url(/public/img/IMG_9851-1200x800.jpg);">
        <div class="bg-overlay"></div>
        <div class="inner-container">
            <a href="/" class="nav-btn"><span class="icon-home"></span></a>
            <div class="title">
                <h3>
                    <a href="/" title="Permalink to Homepage" rel="bookmark">Bowen</a>
                </h3>
                <h4>Have a nice day</h4>
            </div>
        </div>
    </div>
</header>

    <div class="main-menu">
    <div class="menu-expander">
        <a class="nav-expander fixed" id="nav-expander"><span></span></a>
    </div>
    <header>
        <h1>Hey There</h1>
        <p>网站正在建设中，部分功能尚未完工</p>
    </header>
    <nav>
        <ul>
            <li>
                <!-- <a href="#" class="active">technology</a> -->
                <a href="/category/work/">工作</a>
                <span class="icon icon-plus"></span>
                <ul class="sub-menu">
                    <!-- <li><a href="#" class="active">HTML/CSS</a></li> -->
                    <li><a href="/category/html_css/">HTML/CSS</a></li>
                    <li><a href="/category/js/">JS</a></li>
                    <li><a href="/category/nodejs/">NodeJs</a></li>
                    <li><a href="/category/others/">其他</a></li>
                </ul>
            </li>
            <li>
                <a href="/category/life/">生活</a>
                <span class="icon icon-plus"></span>
                <ul class="sub-menu">
                    <li><a href="/category/essay/">随笔</a></li>
                    <li><a href="/category/journal/">记录</a></li>
                </ul>
            </li>
            <li>
                <a href="/about">about</a>
            </li>
        </ul>
    </nav>
    <footer>
        <ul class="clearfix">
            <li>
                <a href="mailto:fantastic.bowen@gmail.com" title="Mail"><span class="icon-mail"></span></a>
            </li>
            <li>
                <a href="#" title="Github"><span class="icon-github"></span></a>
            </li>
            <li>
                <a href="#" title="Share"><span class="icon-share"></span></a>
            </li>
            <li>
                <a href="/about" title="about"><span class="icon-user"></span></a>
            </li>
        </ul>
        <p><small>All code on this site is under <a href="http://opensource.org/licenses/MIT" target="_blank" class="bold-link">MIT License</a></small></p>
        <p><small>Hope you enjoy this~</small></p>
    </footer>
</div>


    <main class="content" role="main">
      <div class="center">
        <div class="post">
    <article class="post-container">
        <header class="post-header">
            <h1 class="post-title">科学上网--使用VPS搭建shadowsocks服务器</h1>
            <div class="post-meta clearfix">
                
                <div class="meta date">
                    <span class="icon-pie-graph"></span>
                    2015-12-10
                </div>
                

                
                <div class="meta tags">
                    <span class="icon-tag"></span>
                    
                    <a href="/tag/shadowsocks/">#shadowsocks</a>
                    
                </div>
                
            </div>
        </header>
        <div class="post-content">
            <h4 id="一准备">一、准备：</h4>
<ul>
  <li>VPS: CentOS 7 64-Bit</li>
  <li>PC: Win8 64bin</li>
  <li>Shadowsocks客户端 （作者clowwindy在15年8月被请去喝茶，无奈删除Github上的所有内容，之前还能在某网盘下载，现在好多资源都删掉了，所以常规方法已经很难找到）</li>
</ul>

<p>官方推荐：</p>

<blockquote>
  <p>建议选择 Ubuntu 14.04 LTS 作为服务器以便使用 <a href="https://github.com/shadowsocks/shadowsocks/wiki/TCP-Fast-Open">TCP Fast Open</a>。除非有明确理由，不建议用对新手不友好的 CentOS。</p>
</blockquote>

<blockquote>
  <p>为了更好的性能，VPS 尽量选择 XEN 或 KVM，不要使用 OpenVZ。推荐使用以下 VPS：</p>
</blockquote>

<blockquote>
  <ol>
    <li>
      <p><a href="https://www.digitalocean.com/?refcode=b1cddd149721">Digital Ocean</a> 自带的内核无需自己编译模块即可使用 <a href="https://github.com/shadowsocks/shadowsocks/wiki/Optimizing-Shadowsocks">hybla</a> 算法</p>
    </li>
    <li>
      <p><a href="https://www.linode.com/?r=e7932c8b03f9abc8aab71663b90b689a676402d1">Linode</a> 功能强大，机房较多</p>
    </li>
  </ol>
</blockquote>

<h4 id="二配置nodejs">二、配置–Nodejs</h4>

<p>首先如果你的服务器访问量巨大的话，不建议使用nodejs搭建shadowsocks，原作者说过：</p>

<blockquote>
  <p>The GC of node.js sucks.
Python version handles 5000 connections with 50MB RAM while node.js version handles 100 connections with 300MB RAM. Why should we continue to support node.js?</p>
</blockquote>

<p>但是本人服务器只有自己用，负担很小，而且身为前端开发者，Nodejs用起来是最顺手的，部署起来也是最简单的，所以还是需要了解一下。</p>

<p>需要环境：Node.js、npm（nodejs安装成功后npm也就可以使用了）、pm2，环境配置请参考<a href="http://zbw.name/blog/2015/10/08/aliyun-nodejs/">上一篇文章</a></p>

<h5 id="1安装shadowsocks">1.安装Shadowsocks</h5>

<p><code class="highlighter-rouge">npm install -g shadowsocks</code></p>

<p>Shadowsocks会被安装到/home/node/v4.1.2/lib/node_modules目录下</p>

<h5 id="2服务器端配置">2.服务器端配置</h5>

<p>进入shadowsocks安装目录</p>

<p><code class="highlighter-rouge">cd /home/node/v4.1.2/lib/node_modules/shadowsocks</code></p>

<p>打开配置文件</p>

<p><code class="highlighter-rouge">vi config.json</code></p>

<p>按I键进入编辑模式，修改配置文件，以下供参考</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nt">"server"</span><span class="p">:</span><span class="s2">"0.0.0.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"server_port"</span><span class="p">:</span><span class="mi">3999</span><span class="err">（监听端口，可自己定义，不要与其他端口冲突）</span><span class="p">,</span><span class="w">
    </span><span class="nt">"local_address"</span><span class="p">:</span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"local_port"</span><span class="p">:</span><span class="mi">1080</span><span class="p">,</span><span class="w">
    </span><span class="nt">"password"</span><span class="p">:</span><span class="s2">"password"</span><span class="err">（密码自定义）</span><span class="p">,</span><span class="w">
    </span><span class="nt">"timeout"</span><span class="p">:</span><span class="mi">600</span><span class="p">,</span><span class="w">
    </span><span class="nt">"method"</span><span class="p">:</span><span class="s2">"aes-256-cfb"</span><span class="err">（加密方式，默认就好）</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>修改之后按‘esc’键，之后按‘:x’保存并退出</p>

<p>此时执行命令<code class="highlighter-rouge">ssserver</code>，就会出现下图所示结果，表示服务开启成功</p>

<p><img src="http://bowen-blog.b0.upaiyun.com/img/2015/121001.png" alt="服务开启成功" /></p>

<h5 id="3客户端配置">3.客户端配置</h5>

<p>在PC端打开下载好的Shadowsocks GUI，在右下角任务栏的小飞机图表单击鼠标右键，然后点击编辑服务器</p>

<p><img src="http://bowen-blog.b0.upaiyun.com/img/2015/121002.png" alt="" /></p>

<p>配置“服务器IP”为VPS的IP地址，其他信息为配置文件中的内容</p>

<p><img src="http://bowen-blog.b0.upaiyun.com/img/2015/121003.png" alt="" /></p>

<p>配置完成后右键小飞机图标，启动系统代理，之后访问<a href="https://www.facebook.com">facebook</a>尝试一下，如果能打开就恭喜配置成功了。</p>

<h5 id="4使用pm2管理vps上的shadowsocks服务">4.使用pm2管理VPS上的Shadowsocks服务</h5>

<p>在VPS端输入命令 <code class="highlighter-rouge">npm install -g pm2</code>安装pm2，安装成功后输入<code class="highlighter-rouge">pm2 start list</code>，如果出现下图所示则表示安装成功</p>

<p><img src="http://bowen-blog.b0.upaiyun.com/img/2015/121004.png" alt="" /></p>

<p>然后输入<code class="highlighter-rouge">pm2 start ssserver</code>，出现下图所示则表示服务开启成功，再次访问facebook或google验证</p>

<p><img src="http://bowen-blog.b0.upaiyun.com/img/2015/121005.png" alt="" /></p>

<p>以后可通过<code class="highlighter-rouge">pm2 list</code>来查看开启的服务，<code class="highlighter-rouge">pm2 restart 服务名（如本例的试试ssserver）</code>来重启服务，<code class="highlighter-rouge">pm2 stop服务名</code>停止服务，<code class="highlighter-rouge">pm2 delete 服务名</code>删除服务，更多pm2使用方法可输入<code class="highlighter-rouge">pm2 --help</code>或查询<a href="http://pm2.keymetrics.io/">官网</a></p>

<h5 id="5shadowsocks使用简介">5.Shadowsocks使用简介</h5>

<p>SS有两种代理模式，全局模式和PAC模式（默认PAC模式），全局模式会代理所有您访问的网站，包括国内的百度、淘宝等，PAC仅会代理PAC文件列表中的网站，所以一般建议采取默认的PAC模式。</p>

<p>PAC文件默认包含常用被墙网站的URL，包括google、faceboo、youtube等，如果访问其他某些国外网站出现打不开的情况，可以右键小飞机图标–&gt;PAC–&gt;编辑本地PAC文件来添加您想要代理的网站</p>

<h4 id="三使用python搭建服务器">三、使用python搭建服务器</h4>
<p>这个是原作者推荐的安装方式，本来想自己写一个的，但是发现网上有位朋友已经总结的非常好，我就不在班门弄斧了，请移步 <a href="http://shadowsocks.blogspot.com/">http://shadowsocks.blogspot.com/</a></p>

        </div>
    </article>
</div>
<script>
    var pres = document.getElementsByTagName('pre');
    for(var pre in pres){
        pres[pre].className = 'line-numbers';
    }
</script>
<script src="/public/js/vendor/prism.js"></script>

      </div>
    </main>

    <footer class="main-footer">
    <div class="copyright">
        <p><small>© 2016 Bowen. All rights reserved.</small></p>
        <p><small>Built with <a href="http://jekyllrb.com/" target="_blank" class="bold-link">Jekyll</a></small></p>
        <p><small>Proudly designed by myself.</small></p>
    </div>
</footer>

  </div>
  <!--<script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script src="http://cdn.bootcss.com/gsap/latest/TweenMax.min.js"></script>
    <script src="http://cdn.bootcss.com/Swiper/3.0.7/js/swiper.min.js"></script>-->
<script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
<!-- <script src="/public/js/vendor/jquery.pjax.js"></script> -->
<script>
window.jQuery || document.write('<script src="/public/js/vendor/jquery.min.js"><\/script>')
</script>
<script src="/public/js/plugins.js"></script>
<script src="/public/js/index.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<!--<script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>-->
<script type="text/javascript">
function loadFont() {
    WebFontConfig = {
        google: {
            families: ['PT+Sans:400,700:latin']
        }
    };
    (function() {
        var wf = document.createElement('script');
        wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
            '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
        wf.type = 'text/javascript';
        wf.async = 'true';
        // wf.onload = function(){
        // 	console.log(1);
        // }
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(wf, s);
    })();
}
// window.onload = loadFont();

// $(document).pjax('.next-page', '#pjax-container', { fragment: "#pjax-container", timeout: 10000 });
var currentPage = 1,
	$articleList = $('.article-list'),
	$nextPage = $('.next-page'),
	loadLock = false; 
$('.next-page').click(function(event) {
	if(loadLock) return false;
	loadLock = true;
	$nextPage.addClass('active');
	$.get($(this).attr('href'), function(data) {
		var $result = $(data);
		var pageNum = $result.find('.next-page').attr('href');
		if(pageNum){
			$articleList.append($result.find('.article-list article'));
			$nextPage.attr('href', $result.find('.next-page').attr('href'));
		}else{
			$nextPage.find('.load-text').text('没有了');
		}
		$nextPage.removeClass('active');
		loadLock = false;
	});
	// console.log($(this).attr('href'));
	return false;
});
</script>

  </body>

</html>
