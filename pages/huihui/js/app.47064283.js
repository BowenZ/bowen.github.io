(function(t){function e(e){for(var n,l,o=e[0],i=e[1],u=e[2],d=0,f=[];d<o.length;d++)l=o[d],s[l]&&f.push(s[l][0]),s[l]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);c&&c(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var i=a[o];0!==s[i]&&(n=!1)}n&&(r.splice(e--,1),t=l(l.s=a[0]))}return t}var n={},s={app:0},r=[];function l(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=n,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)l.d(a,n,function(e){return t[e]}.bind(null,n));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var c=i;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("bd13"),a("1520");var n=a("0404"),s=a.n(n),r=(a("0955"),a("805a")),l=a.n(r),o=(a("1619"),a("86d3")),i=a.n(o),u=(a("924e"),a("c4b9")),c=a.n(u),d=(a("97c9"),a("fe6f")),f=a.n(d),p=(a("508b"),a("3980")),h=a.n(p),g=(a("d3a3"),a("f464")),v=a.n(g),b=(a("06aa"),a("5065")),w=a.n(b),m=(a("cadf"),a("551c"),a("097d"),a("2b0e")),y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"app","element-loading-text":"拼命计算中"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"select-file"},[a("input",{staticStyle:{"margin-right":"10px"},attrs:{type:"file",id:"file",placeholder:"请选择文件"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleSubmit}},[t._v("(～￣▽￣)～确定")])],1)]),a("el-col",{attrs:{span:12}},[t.dataList?a("div",{staticClass:"search"},[a("el-input",{attrs:{placeholder:"按姓名或编号搜索(￣▽￣)~*"},model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:"searchInput"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){t.searchVal=t.searchInput}},slot:"append"},[t._v("搜索")])],1)],1):t._e()])],1),a("div",{staticClass:"table-wrapper"},[t.dataList?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataList.filter(function(e){return!t.searchVal||e.name.includes(t.searchVal)||e.id.includes(t.searchVal)}),height:"90vh"}},[a("el-table-column",{attrs:{prop:"id",label:"编号","min-width":"100px",fixed:""}}),a("el-table-column",{attrs:{prop:"name",label:"姓名","min-width":"100px",fixed:""}}),a("el-table-column",{attrs:{label:"日期"}},[a("el-table-column",{attrs:{label:"星期"}})],1),t._l(t.monthDate,function(e,n){return a("el-table-column",{key:n,attrs:{label:String(e.day),prop:"data"}},[a("el-table-column",{attrs:{label:e.weekCn.replace("星期",""),prop:"data"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"today-state",on:{click:function(a){t.handleShowDetail(e.row.data[n].data)}}},["k"==e.row.data[n].status?a("span",{staticClass:"state-red",attrs:{type:"danger"}},[t._v(t._s(e.row.data[n].statusCn))]):"q"==e.row.data[n].status?a("span",{staticClass:"state-yellow",attrs:{type:"info"}},[t._v(t._s(e.row.data[n].statusCn))]):"c"==e.row.data[n].status?a("span",{staticClass:"state-purple",attrs:{type:"warning"}},[t._v(t._s(e.row.data[n].statusCn))]):"z"==e.row.data[n].status?a("span",{staticClass:"state-purple",attrs:{type:"warning"}},[t._v(t._s(e.row.data[n].statusCn))]):"cz"==e.row.data[n].status?a("span",{staticClass:"state-purple",attrs:{type:"warning"}},[t._v(t._s(e.row.data[n].statusCn))]):"n"==e.row.data[n].status?a("span",[t._v(t._s(e.row.data[n].statusCn))]):"j"==e.row.data[n].status?a("span",{staticClass:"state-blue"},[t._v(t._s(e.row.data[n].statusCn))]):a("span",[t._v("-")])])]}}])})],1)})],2):t._e()],1),a("el-dialog",{attrs:{title:"明细数据",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.detailData?a("div",{staticClass:"dialog-content"},[a("h3",[t._v("人员编号："+t._s(t.detailData[0]["人员编号"]))]),a("h3",[t._v("姓名："+t._s(t.detailData[0]["姓名"]))]),a("h4",[t._v("考勤时间：")]),a("ul",{staticStyle:{"list-style":"none",margin:"0",padding:"0"}},t._l(t.detailData,function(e,n){return a("li",{key:n},[t._v(t._s(e["考勤时间"]))])}))]):a("p",[t._v("无打卡数据")])])],1)},_=[],C=a("2909"),k=(a("55dd"),a("456d"),a("ac6a"),document.querySelector.bind(document));function S(t,e){e=parseInt(e,10);var a=new Date(t,e,0);return a.getDate()}function j(t,e){for(var a=S(t,e),n=new Date(t,e-1,1),s=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],r=[],l=1;l<=a;l++)n.setDate(l),r.push({week:n.getDay(),weekCn:s[n.getDay()],day:l});return r}var D={name:"landing-page",data:function(){return{searchInput:"",searchVal:"",monthDate:null,dataList:null,detailData:null,dialogVisible:!1,fullscreenLoading:!1}},methods:{dateFilter:function(t){return t&&t.join?t.map(function(t){return t["考勤时间"]}).join("<br>"):""},handleShowDetail:function(t){console.log("====data====",t),this.detailData=t,this.dialogVisible=!0},handleSubmit:function(){var t=this;this.fullscreenLoading=!0;try{if(!k("#file").files[0])return void this.$message({message:"要先选择xlsx文件",type:"warning"});var e=k("#file").files,a=new FileReader;a.onload=function(e){try{var a=e.target.result,n=XLSX.read(a,{type:"binary"}),s=[]}catch(d){return void console.log("文件类型不正确")}var r="";for(var l in n.Sheets)n.Sheets.hasOwnProperty(l)&&(r=n.Sheets[l]["!ref"],console.log("fromTo",r),s=s.concat(XLSX.utils.sheet_to_json(n.Sheets[l])));console.log(s),console.log("====time====",s[0]["考勤时间"]);var o=new Date(s[0]["考勤时间"]),i=j(o.getFullYear(),o.getMonth());t.monthDate=i;var u={};s.forEach(function(t){t.date=new Date(t["考勤时间"]),u[t["人员编号"]]||(u[t["人员编号"]]=[]),u[t["人员编号"]].push(t)});var c=[];Object.keys(u).forEach(function(t){var e=u[t],a={id:t,name:u[t][0]["姓名"]};a.data=i.map(function(t){var a,n=e.filter(function(e){return e.date.getDate()==t.day});if(n&&n.length)if(n.sort(function(t,e){return t.date-e.date}),0==t.week||6==t.week)a={status:"j",statusCn:"加班",data:Object(C["a"])(n)};else{var s=!1,r=!1,l=!1;n.length<2&&(l=!0),(n[0].date.getHours()>8||8==n[0].date.getHours()&&n[0].date.getMinutes()>30)&&(s=!0),n[n.length-1].date.getHours<18&&(r=!0),l?a={status:"q",statusCn:"缺卡",data:Object(C["a"])(n)}:s&&r?(console.log("====迟到+早退====",n),a={status:"cz",statusCn:"迟到+早退",data:Object(C["a"])(n)}):a=s?{status:"c",statusCn:"迟到",data:Object(C["a"])(n)}:r?{status:"z",statusCn:"早退",data:Object(C["a"])(n)}:{status:"n",statusCn:"正常",data:Object(C["a"])(n)}}else a=0==t.week||6==t.week?{status:"n",statusCn:""}:{status:"k",statusCn:"无记录"};return a.week=t.week,a}),c.push(a)}),console.log("====group====",u),console.log("====ret====",c),t.dataList=c,window.requestAnimationFrame?window.requestAnimationFrame(function(){t.$nextTick(function(){t.fullscreenLoading=!1})}):setTimeout(function(){t.$nextTick(function(){t.fullscreenLoading=!1})},1e3)},a.readAsBinaryString(e[0])}catch(n){console.log("====err====",n),alert("啊呦，出错了，检查一下文件是否正确")}}}},x=D,O=(a("5c0b"),a("2877")),L=Object(O["a"])(x,y,_,!1,null,null,null);L.options.__file="App.vue";var V=L.exports;m["default"].use(w.a),m["default"].use(v.a),m["default"].use(h.a),m["default"].use(f.a),m["default"].use(c.a),m["default"].use(i.a),m["default"].use(l.a.directive),m["default"].use(s.a),m["default"].config.productionTip=!1,new m["default"]({render:function(t){return t(V)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var n=a("5e27"),s=a.n(n);s.a},"5e27":function(t,e,a){}});
//# sourceMappingURL=app.47064283.js.map